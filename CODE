(in progress)

-- 1. Understand dataset: What is the top keywords in Google Trends and its percentage within dataset?

WITH cte AS (
    SELECT 
      term, 
      COUNT(term) as count_term,
      (SELECT COUNT(term) FROM bigquery-public-data.google_trends.top_terms) AS count_total
    FROM 
      bigquery-public-data.google_trends.top_terms
    GROUP BY
      term 
    ORDER BY
      count_term desc
    )  

SELECT 
    term, 
    count_term, 
    count_total,
    ROUND (count_term/count_total*100, 2) AS percentage_pie
FROM 
    cte
;
